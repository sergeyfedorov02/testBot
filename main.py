import telebot
from telebot import types

import config


# –°–æ–∑–¥–∞–µ–º –∫–ª–∞—Å—Å –Ω–∞—à–µ–≥–æ –≤–∏–¥–µ–æ, —á—Ç–æ–±—ã —Ö—Ä–∞–Ω–∏—Ç—å —Ç–∞–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–µ–º
class VideoInfo:
    def __init__(self):
        self.url = None  # URL —Ç–µ–∫—É—â–µ–≥–æ –≤–∏–¥–µ–æ
        self.last_GIF = None  # True - –µ—Å—Ç—å —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥–∏—Ñ–∫–∞, –∑–Ω–∞—á–∏—Ç –º–æ–∂–Ω–æ –µ–µ –ø—Ä–∏—Å–ª–∞—Ç—å –µ—â–µ —Ä–∞–∑
        self.id = None  # Id –≤–∏–¥–µ–æ
        self.views = None  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –≤–∏–¥–µ–æ
        self.date = None  # –î–∞—Ç–∞ –≤—ã–ø—É—Å–∫–∞ –≤–∏–¥–µ–æ
        self.duration = None  # –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∏–¥–µ–æ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        self.title = None  # –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ
        self.wait_answer = True  # True - –∂–¥–µ–º –æ—Ç–≤–µ—Ç–∞ –∏–∑ callback —Ñ—É–Ω–∫—Ü–∏–∏ (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫)
        self.message_inline_button_id = None  # Id —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –±–æ—Ç–∞ —Å Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –µ–µ —É–¥–∞–ª–∏—Ç—å
        self.wait_GIF = False  # True - —Å–µ–π—á–∞—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è GIF-–∫–∞, —á—Ç–æ–±—ã –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –¥—Ä—É–≥–∏–µ –¥–µ–π—Å—Ç–≤–∏—è


if __name__ == '__main__':
    # –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫–ª–∞—Å—Å–∞ TeleBot, –∫—É–¥–∞ –ø–µ—Ä–µ–¥–∞–¥–∏–º TOKEN –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞
    bot = telebot.TeleBot(config.TOKEN)

    # –î–ª—è –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–≤–µ–¥–µ–º —Å–ª–æ–≤–∞—Ä—å, –≥–¥–µ key - chat.id –∏ value - –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ VideoInfo
    chat_dict = {}


    # –ù–∞–ø–∏—à–µ–º –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π /start
    @bot.message_handler(commands=['start'])
    def welcome(message):
        chat_id = message.chat.id  # –ü–æ–ª—É—á–µ–º id —á–∞—Ç–∞

        # –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ª–∏ —Å–µ–π—á–∞—Å GIF-–∫–∞?
        if chat_id in chat_dict.keys() and chat_dict[chat_id].wait_GIF:
            bot.reply_to(message, "üïê –°–µ–π—á–∞—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è GIF-–∫–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ, –∞ –∑–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —Å–≤–æ–π –∑–∞–ø—Ä–æ—Å üïê")

        else:

            # –ë—ã–ª –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–∞—Ç–∞ -> —É–¥–∞–ª–∏–º Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É, –µ—Å–ª–∏ –æ–Ω–∞ –æ—Å—Ç–∞–ª–∞—Å—å
            if chat_id in chat_dict.keys() and chat_dict[chat_id].message_inline_button_id is not None:
                bot.edit_message_reply_markup(chat_id=chat_id, message_id=chat_dict[chat_id].message_inline_button_id,
                                              reply_markup=None)

            # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ VideoInfo, –≥–¥–µ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –∏–Ω—Ñ–æ –æ –≤–∏–¥–µ–æ
            video_info = VideoInfo()

            # –°–æ–∑–¥–∞–µ–º –≤ —Å–ª–æ–≤–∞—Ä–µ chat_dict –ø–∞—Ä—É, –≥–¥–µ key - id —á–∞—Ç–∞, value - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∏–¥–µ–æ
            chat_dict[chat_id] = video_info

            # –û—Ç—Å—ã–ª–∞–µ–º —Å—Ç–∏–∫–µ—Ä
            sticker = open('AnimatedSticker.tgs', 'rb')
            bot.send_sticker(message.chat.id, sticker)

            # –û—Ç—Å—ã–ª–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            bot.send_message(chat_id,
                             "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {0.first_name}!\n"
                             "–Ø - <b>{1.first_name}</b>, –±–æ—Ç –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è GIF-–∫–∏ –∏–∑ –≤–∏–¥–µ–æ —Å YouTube –ø—Ä–∏ –ø–æ–º–æ—â–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–π–º—Å—Ç–µ–ø–æ–≤."
                             "\n\n<b>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>"
                             "\n/start - –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"
                             "\n/help - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥"
                             "\n/getInfoAboutVideo - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º –≤–∏–¥–µ–æ (–ø–æ—Å–ª–µ–¥–Ω–µ–µ URL)"
                             "\n/getInfoAboutYouTuber - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º –Æ—Ç—É–±–µ—Ä–µ (–ø–æ—Å–ª–µ–¥–Ω–µ–µ URL)"
                             "\n\n–ü—Ä–∏—à–ª–∏—Ç–µ –º–Ω–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ä–æ–ª–∏–∫ –≤ YouTube üòä".format(message.from_user, bot.get_me()),
                             parse_mode='html', reply_markup=types.ReplyKeyboardRemove())


    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.polling(none_stop=True)
